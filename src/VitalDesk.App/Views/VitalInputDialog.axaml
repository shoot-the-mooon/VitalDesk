<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="using:FluentAvalonia.UI.Controls"
        xmlns:vm="using:VitalDesk.App.ViewModels"
        x:Class="VitalDesk.App.Views.VitalInputDialog"
        x:DataType="vm:VitalInputViewModel"
        Width="620"
        Height="600"
        MinHeight="400"
        MaxHeight="600"
        SizeToContent="Manual"
        WindowStartupLocation="CenterOwner"
        Title="バイタルサイン入力">
    
    <ScrollViewer Margin="10" 
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled"
                  AllowAutoHide="True">
        <StackPanel Spacing="10">
            
             <!-- 測定日時情報 -->
            
                <StackPanel Spacing="5" MaxWidth="600" HorizontalAlignment="Center" Margin="0,0,0,0">           
                    <!-- 日付選択 -->
                    <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                            CornerRadius="4"
                            Padding="10">
                        <StackPanel Spacing="15">
                            <TextBlock Text="上書きしたい場合は日付を選択して保存ボタン" 
                                       FontWeight="SemiBold"
                                       FontSize="14"
                                       HorizontalAlignment="Center"/>
                            
                            <!-- 日付表示とボタン -->
                            <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto">
                                <!-- 日付表示 -->
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding MeasuredAtFullWidthString}"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Padding="20,10"/>
                                
                                <!-- 上ボタン（日付を1日進める） -->
                                <Button Grid.Row="0" Grid.Column="2"
                                        Content="▶︎"
                                        FontSize="12"
                                        Width="30"
                                        Height="30"
                                        Padding="0"
                                        Click="OnDateUpClick"
                                        ToolTip.Tip="日付を1日進める"/>
                                
                                <!-- 下ボタン（日付を1日戻す） -->
                                <Button Grid.Row="0" Grid.Column="0"
                                        Content="◀︎"
                                        FontSize="12"
                                        Width="30"
                                        Height="30"
                                        Padding="0"
                                        Click="OnDateDownClick"
                                        ToolTip.Tip="日付を1日戻す"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            
            <!-- バイタルサイン入力 - 2列レイアウト -->
            <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="4"
                    Padding="20">
                <StackPanel Spacing="20">
                    <!-- 2列グリッドレイアウト -->
                    <Grid ColumnDefinitions="*,20,*" RowDefinitions="Auto,20,Auto,20,Auto">
                        
                        <!-- 左列: 体温と脈拍 -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Spacing="20">
                            
                            <!-- 体温 -->
                            <Border Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="4"
                                    Padding="10"
                                    Height="120">
                                <StackPanel Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="体温" 
                                               FontWeight="SemiBold"
                                               FontSize="16"
                                               Margin="8,0,8,16"
                                               HorizontalAlignment="Center"/>
                                    <NumericUpDown Value="{Binding Temperature}"
                                                   Minimum="30"
                                                   Maximum="45"
                                                   Increment="0.1"
                                                   FormatString="F1"
                                                   FontSize="16"
                                                   Height="40"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- 脈拍 -->
                            <Border Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="4"
                                    Padding="10"
                                    Height="100">
                                <StackPanel Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="脈拍" 
                                               FontWeight="SemiBold"
                                               FontSize="16"
                                               HorizontalAlignment="Center"/>
                                    <NumericUpDown Value="{Binding Pulse}"
                                                   Minimum="30"
                                                   Maximum="200"
                                                   Increment="1"
                                                   FontSize="16"
                                                   Height="40"/>
                                </StackPanel>
                            </Border>
                            
                        </StackPanel>
                        
                        <!-- 右列: 血圧と体重 -->
                        <StackPanel Grid.Row="0" Grid.Column="2" Spacing="20">
                            
                            <!-- 血圧 -->
                            <Border Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="4"
                                    Padding="10"
                                    Height="120">
                                <StackPanel Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="血圧" 
                                               FontWeight="SemiBold"
                                               FontSize="16"
                                               HorizontalAlignment="Center"/>
                                    
                                    <Grid ColumnDefinitions="*,Auto,*" RowDefinitions="Auto,Auto,Auto">
                                        <StackPanel Grid.Column="0" Spacing="6">
                                            <TextBlock Text="収縮期" FontSize="12" 
                                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                       HorizontalAlignment="Center"/>
                                            <NumericUpDown Value="{Binding Systolic}"
                                                           Minimum="50"
                                                           Maximum="250"
                                                           Increment="1"
                                                           FontSize="14"
                                                           Height="35"/>
                                        </StackPanel>
                                        
                                        <TextBlock Grid.Column="1" Text="/" 
                                                   VerticalAlignment="Bottom"
                                                   Margin="8,0,8,8"
                                                   FontWeight="Bold"
                                                   FontSize="16"/>
                                        
                                        <StackPanel Grid.Column="2" Spacing="6">
                                            <TextBlock Text="拡張期" FontSize="12"
                                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                       HorizontalAlignment="Center"/>
                                            <NumericUpDown Value="{Binding Diastolic}"
                                                           Minimum="30"
                                                           Maximum="150"
                                                           Increment="1"
                                                           FontSize="14"
                                                           Height="35"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- 体重 -->
                            <Border Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                    CornerRadius="4"
                                    Padding="10"
                                    Height="100">
                                <StackPanel Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="体重" 
                                               FontWeight="SemiBold"
                                               FontSize="16"
                                               HorizontalAlignment="Center"/>
                                    <NumericUpDown Value="{Binding Weight}"
                                                   Minimum="1"
                                                   Maximum="300"
                                                   Increment="0.1"
                                                   FormatString="F1"
                                                   FontSize="16"
                                                   Height="40"/>
                                </StackPanel>
                            </Border>
                            
                        </StackPanel>
                        
                        <!-- 3行目 左列: 食事 -->
                        <Border Grid.Row="2" Grid.Column="0"
                                Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                CornerRadius="4"
                                Padding="10"
                                Height="120">
                            <StackPanel Spacing="12" VerticalAlignment="Center">
                                <TextBlock Text="食事" 
                                           FontWeight="SemiBold"
                                           FontSize="16"
                                           HorizontalAlignment="Center"/>
                                <UniformGrid Columns="3" Rows="1" HorizontalAlignment="Center" Margin="0,4,0,0">
                                    <!-- 朝食 -->
                                    <StackPanel Spacing="4" HorizontalAlignment="Center">
                                        <TextBlock Text="朝食" FontSize="12"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                        <ComboBox SelectedItem="{Binding Breakfast, Mode=TwoWay}"
                                                  Width="60"
                                                  HorizontalAlignment="Center">
                                            <x:String>○</x:String>
                                            <x:String>×</x:String>  
                                        </ComboBox>
                                    </StackPanel>
                                    <!-- 昼食 -->
                                    <StackPanel Spacing="4" HorizontalAlignment="Center">
                                        <TextBlock Text="昼食" FontSize="12"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                        <ComboBox SelectedItem="{Binding Lunch, Mode=TwoWay}"
                                                  Width="60"
                                                  HorizontalAlignment="Center">
                                            <x:String>○</x:String>
                                            <x:String>×</x:String>
                                        </ComboBox>
                                    </StackPanel>
                                    <!-- 夕食 -->
                                    <StackPanel Spacing="4" HorizontalAlignment="Center">
                                        <TextBlock Text="夕食" FontSize="12"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                        <ComboBox SelectedItem="{Binding Dinner, Mode=TwoWay}"
                                                  Width="60"
                                                  HorizontalAlignment="Center">
                                            <x:String>○</x:String>
                                            <x:String>×</x:String>
                                        </ComboBox>
                                    </StackPanel>
                                </UniformGrid>
                            </StackPanel>
                        </Border>
                        
                        <!-- 3行目 右列: 睡眠と便通 -->
                        <Border Grid.Row="2" Grid.Column="2"
                                Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                CornerRadius="4"
                                Padding="10"
                                Height="120">
                            <StackPanel Spacing="12" VerticalAlignment="Center">
                                <TextBlock Text="睡眠・便通" 
                                           FontWeight="SemiBold"
                                           FontSize="16"
                                           HorizontalAlignment="Center"/>
                                
                                <Grid ColumnDefinitions="*,20,*" RowDefinitions="Auto,Auto,Auto">
                                    <!-- 睡眠 -->
                                    <StackPanel Grid.Column="0" Spacing="6">
                                        <TextBlock Text="睡眠" FontSize="12" 
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                        <NumericUpDown Value="{Binding Sleep}"
                                                       Minimum="0"
                                                       Maximum="24"
                                                       Increment="1"
                                                       FontSize="14"
                                                       Height="35"/>
                                    </StackPanel>
                                    
                                    <!-- 便通 -->
                                    <StackPanel Grid.Column="2" Spacing="6">
                                        <TextBlock Text="便通" FontSize="12"
                                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                                   HorizontalAlignment="Center"/>
                                        <NumericUpDown Value="{Binding BowelMovement}"
                                                       Minimum="0"
                                                       Maximum="20"
                                                       Increment="1"
                                                       FormatString="N0"
                                                       ShowButtonSpinner="True"
                                                       FontSize="14"
                                                       Height="35"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- 4行目: 備考 (2列にまたがる) -->
                        <Border Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="3"
                                Background="{DynamicResource SubtleFillColorSecondaryBrush}"
                                CornerRadius="4"
                                Padding="10">
                            <StackPanel Spacing="12">
                                <TextBlock Text="備考" 
                                           FontWeight="SemiBold"
                                           FontSize="16"
                                           HorizontalAlignment="Center"/>
                                <TextBox Text="{Binding Note}"
                                         FontSize="14"
                                         MinHeight="80"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True"
                                         Watermark="備考を入力（任意）"/>
                            </StackPanel>
                        </Border>
                        
                    </Grid>
                    
                </StackPanel>
            </Border>
            
           

            <!-- ボタン -->
            <StackPanel Orientation="Horizontal" 
                        HorizontalAlignment="Right" 
                        Spacing="15"
                        Margin="0,10,0,0">
                <Button Content="キャンセル" 
                        Command="{Binding CancelCommand}"
                        FontSize="16"
                        Padding="20,10"
                        MinWidth="100"/>
                <Button Content="{Binding SaveButtonText}" 
                        Command="{Binding SaveCommand}"
                        Classes="accent"
                        IsEnabled="{Binding !IsSaving}"
                        FontSize="16"
                        Padding="20,10"
                        MinWidth="100"/>
            </StackPanel>
            
        </StackPanel>
    </ScrollViewer>
</Window>
